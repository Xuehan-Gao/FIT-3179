{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 600,
  "height": 400,
  "title": "Incidents of Top 10 Countries (2012-2022)",
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/Xuehan-Gao/FIT-3179/master/Global_Terrorism_Index_2023.csv"
      },
      "selection": {
        "selectedYear": {
          "type": "single",
          "fields": ["Year"],
          "init": {"Year": "2012"},
          "bind": {
            "Year": {
              "name": "Select Year",
              "input": "select",
              "options": [
                "2012",
                "2013",
                "2014",
                "2015",
                "2016",
                "2017",
                "2018",
                "2019",
                "2020",
                "2021",
                "2022"
              ]
            }
          }
        }
      },
      "transform": [
        {"filter": {"selection": "selectedYear"}},
        {"window": [{"op": "rank", "field": "Rank", "as": "ranked"}]},
        {"filter": "datum.ranked <= 10"}
      ],
      "mark": "bar",
      "encoding": {
        "x": {
          "field": "Country",
          "type": "nominal",
          "title": "Country",
          "scale": {"padding": 0}
        },
        "y": {
          "field": "Incidents",
          "type": "quantitative",
          "title": "Incidents"
        },
        "color": {
          "field": "Country",
          "type": "nominal",
          "title": "Country",
          "legend": {"selectors": true}
        },
        "tooltip": [
          {"field": "Country", "type": "nominal", "title": "Country"},
          {"field": "Year", "type": "ordinal", "title": "Year"},
          {
            "field": "Incidents",
            "type": "quantitative",
            "title": "Incidents",
            "format": ","
          }
        ],
        "opacity": {
          "condition": {"selection": "selectedYear", "value": 1},
          "value": 0.2
        }
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/donnnnnnieeeeee011012/ass2/main/Homework_3/data/Hapiness_score_changing.csv"
      },
      "mark": {
        "type": "text",
        "align": "center",
        "baseline": "bottom",
        "dy": -5,
        "fontSize": 11
      },
      "encoding": {
        "x": {"field": "Country", "type": "nominal"},
        "y": {"field": "Incidents", "type": "quantitative"},
        "text": {"field": "Incidents", "type": "quantitative"},
        "opacity": {
          "condition": {"selection": "selectedYear", "value": 1},
          "value": 0
        }
      }
    }
  ],
  "config": {}
}